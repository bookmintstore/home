<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BookMintor Bhagavad Gita Details</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          boxShadow: {
            glow: '0 12px 36px -12px rgba(99,102,241,0.7)',
            ctaglow: '0 12px 40px -12px rgba(168,85,247,.7)',
            book: '0 28px 60px -18px rgba(0, 0, 0, 0.65)'
          },
          keyframes: {
            shine: { '0%': { transform: 'translateX(-140%)' }, '100%': { transform: 'translateX(140%)' } },
            btnshine: { '0%': { transform: 'translateX(-140%) skewX(-30deg)' }, '100%': { transform: 'translateX(220%) skewX(-30deg)' } },
            slideUp: { '0%': {opacity:'0', transform:'translateY(20px)'}, '100%':{opacity:'1', transform:'translateY(0)'} },
            cornerPop: { '0%': { opacity: 0, transform:'scale(.95)' }, '40%': { opacity: .95 }, '100%': { opacity: 0, transform:'scale(1)' } },
            aura: { '0%': { boxShadow: '0 0 12px rgba(168,85,247,0.6)' }, '50%': { boxShadow: '0 0 26px rgba(168,85,247,0.95)' }, '100%': { boxShadow: '0 0 12px rgba(168,85,247,0.6)' } }
          },
          animation: {
            shine: 'shine 1.6s ease-in-out infinite',
            btnshine: 'btnshine 2.6s ease-in-out infinite',
            slideUp: 'slideUp .45s ease-out forwards',
            cornerPop: 'cornerPop .95s ease-out 0.15s 1 forwards',
            aura: 'aura 2.4s ease-in-out infinite'
          }
        }
      }
    }
  </script>

  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    body{font-family:'Poppins',sans-serif}
    .cta-btn{ position:relative; overflow:hidden; animation: aura 2.4s ease-in-out infinite; box-shadow: 0 8px 30px rgba(124,58,237,0.25); }
    .cta-btn .cta-shine{ position:absolute; inset:-6px; transform:translateX(-140%) skewX(-30deg); background:linear-gradient(90deg,rgba(255,255,255,0) 0%, rgba(255,255,255,0.43) 45%, rgba(255,255,255,0.15) 60%, rgba(255,255,255,0) 100%); transition: opacity 0.2s; opacity: 0.90; mix-blend-mode: screen; pointer-events:none; }
    .cta-btn:hover .cta-shine { opacity: 1; }
    .cta-btn .corner-bling{ pointer-events:none; position:absolute; inset:-6px; border-radius:12px; background:
        radial-gradient(160px 160px at 0 0, rgba(255,255,255,.65), transparent 60%),
        radial-gradient(160px 160px at 100% 0, rgba(255,255,255,.5), transparent 60%),
        radial-gradient(160px 160px at 0 100%, rgba(255,255,255,.5), transparent 60%),
        radial-gradient(160px 160px at 100% 100%, rgba(255,255,255,.5), transparent 60%);
      opacity:0; filter: blur(6px); }
    .cta-btn:hover .corner-bling { opacity: .95; }

    details[open] summary svg{transform:rotate(180deg)}
    .details-content{overflow:hidden; height:0; transition:height .32s ease}

    /* BOOK 3D: closed-side realistic */
    .book-wrap { perspective:1600px; display:flex; align-items:center; justify-content:center; }
    .book-3d {
      width: 240px;               /* adjust size */
      height: 340px;
      position: relative;
      transform-style: preserve-3d;
      transform: rotateY(-12deg) rotateX(4deg);
      transition: transform .35s ease;
      margin: 12px;
    }
    .book-3d:hover { transform: rotateY(-8deg) rotateX(6deg) translateY(-8px); }

    /* Cover plate (front) - showing cover image */
    .cover {
      position:absolute;
      width: 100%;
      height: 100%;
      left: 0;
      top: 0;
      transform: translateZ(12px) rotateY(0deg); /* front face offset */
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0,0,0,0.45);
    }
    .cover img { width:100%; height:100%; object-fit:cover; display:block; }

    /* Back cover (for thickness) */
    .back-cover {
      position:absolute; width:100%; height:100%;
      transform: translateZ(-12px) rotateY(180deg);
      border-radius:8px;
      background: #f3f3f4;
    }

    /* Spine - visible left edge */
    .spine {
      position:absolute;
      left: -12px;   /* pulled left so spine sits on left side */
      top: 6px;
      width: 24px;           /* total thickness */
      height: calc(100% - 12px);
      transform-origin: left center;
      transform: rotateY(90deg) translateX(-12px);
      border-radius: 8px 0 0 8px;
      background: linear-gradient(180deg,#e6e6e8,#cfcfd3);
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.06);
    }

    /* Page block (visible thin edge) */
    .pages {
      position:absolute;
      left: -8px;
      top: 10px;
      width: 16px;
      height: calc(100% - 20px);
      transform: rotateY(-90deg) translateX(-8px);
      background: linear-gradient(90deg,#fcfbf9,#f0efe9);
      border-radius: 4px 0 0 4px;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.06);
      overflow:hidden;
    }

    /* top/bottom edges to make it look closed */
    .top-edge {
      position:absolute;
      top: -10px;
      left: 10px;
      width: calc(100% - 20px);
      height: 16px;
      transform: rotateX(90deg) translateY(-10px);
      background: linear-gradient(180deg,#fbfbfb,#f0efef);
      border-radius: 8px 8px 0 0;
    }
    .bottom-edge {
      position:absolute;
      bottom: -10px;
      left: 10px;
      width: calc(100% - 20px);
      height: 16px;
      transform: rotateX(-90deg) translateY(10px);
      background: linear-gradient(180deg,#fbfbfb,#f0efef);
      border-radius: 0 0 8px 8px;
    }

    /* subtle shadow under book for realism */
    .book-ghost {
      position:absolute;
      bottom: -28px;
      left: 20px;
      width: 70%;
      height: 28px;
      background: rgba(0,0,0,0.45);
      border-radius: 50%;
      filter: blur(16px);
      transform: rotateX(90deg);
    }

    /* reflection/highlight */
    .cover::after {
      content:"";
      position:absolute;
      right:-8%;
      top:0;
      width: 44%;
      height:100%;
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.18) 40%, rgba(255,255,255,0.06) 60%, rgba(255,255,255,0) 100%);
      transform: skewX(-10deg) translateX(12px);
      mix-blend-mode: screen;
      pointer-events:none;
    }

    @media (max-width:700px){
      .book-3d { width: 170px; height: 245px; }
    }

    /* small helper for error text */
    .proc-error { color:#f87171; font-weight:600; margin-top:8px; display:none; }
    
    /* ⭐ stars filled + glow */
    .star-glow svg{filter: drop-shadow(0 0 6px rgba(245,158,11,.75))}
    .star-glow svg path{fill: currentColor; stroke: transparent}
    .star-glow .filled{color:#fbbf24}
    .star-glow .half{color:#fbbf24}
    .star-glow .empty{color:#475569;opacity:.45}

    /* Preloader Styles - FIXED */
    #bm-preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(11, 14, 19, 0.4); /* Transparent blur background */
      backdrop-filter: blur(20px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 2.5s ease-out;
    }

    #bm-preloader.fade-out {
      opacity: 0;
    }

    #bm-preloader.hidden {
      display: none;
    }

    .bm-loader {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(139, 92, 246, 0.3); /* Purple matching theme */
      border-top: 4px solid #8b5cf6; /* Purple from buy button */
      border-radius: 50%;
      animation: bm-spin 0.8s linear infinite; /* Faster rotation */
      border-right-color: transparent;
      border-bottom-color: transparent;
      position: fixed; /* Always centered */
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    @keyframes bm-spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
  </style>
</head>
<body class="bg-[#0b0e13] text-white selection:bg-indigo-500/30">
  <!-- Preloader Overlay -->
  <div id="bm-preloader">
    <div class="bm-loader"></div>
  </div>

  <!-- Background blobs (unchanged) -->
  <div class="pointer-events-none fixed inset-0 -z-10">
    <div class="absolute -top-56 -left-40 h-[680px] w-[680px] rounded-full bg-indigo-600/20 blur-[140px]"></div>
    <div class="absolute -bottom-56 -right-40 h-[600px] w-[600px] rounded-full bg-fuchsia-600/20 blur-[140px]"></div>
  </div>

  <!-- Header -->
  <header class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
    <a href="./index.html" class="flex items-center gap-2">
      <div class="grid h-10 w-10 place-items-center rounded-xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 shadow-glow">
        <i data-lucide="book-open" class="w-5 h-5 text-white"></i>
      </div>
      <span class="text-lg font-bold"><span class="bg-gradient-to-r from-indigo-300 to-fuchsia-300 bg-clip-text text-transparent">Book</span>Mintor</span>
    </a>
    <a href="./spirituality.html" class="text-sm text-zinc-300 hover:text-white">Back to Library</a>
  </header>

  <!-- Main content -->
  <section class="max-w-5xl mx-auto px-6 py-12 space-y-10">
    <div class="flex flex-col md:flex-row items-center gap-8">
      <!-- New closed-side 3D book mockup -->
      <div class="book-wrap" data-aos="fade-right">
        <div class="book-3d" id="book3d">
          <!-- cover will contain processed image with transparent bg (if processing succeeds) -->
          <div class="cover" id="coverFace">
            <img id="coverImg" alt="ebook cover (processed)" src="" />
          </div>

          <!-- pages / spine / top-bottom edges -->
          <div class="spine" aria-hidden="true"></div>
          <div class="pages" aria-hidden="true"></div>
          <div class="top-edge" aria-hidden="true"></div>
          <div class="bottom-edge" aria-hidden="true"></div>

          <!-- soft shadow -->
          <div class="book-ghost" aria-hidden="true"></div>
        </div>
      </div>

      <!-- Info -->
      <div class="flex-1 space-y-4" data-aos="fade-left">
        <h1 class="text-3xl font-bold">Bhagavad Gita Demystified</h1>
        <p class="text-zinc-300">A modern interpretation of the 700 verses with practical life applications.</p>
        <div class="text-emerald-400 text-2xl font-extrabold">₹199 
          <span class="ml-2 line-through text-sm text-zinc-400">₹399</span>
          <span class="ml-2 px-2 py-0.5 bg-emerald-600/20 text-emerald-300 rounded-full text-xs font-semibold">50% OFF</span>
        </div>
        <a id="buyBtn" href="#buy" class="cta-btn inline-flex items-center gap-2 rounded-xl bg-gradient-to-br from-indigo-500 to-fuchsia-500 px-5 py-2 text-sm font-semibold shadow-ctaglow transition hover:scale-105 active:scale-95">
          <span>Buy Now</span>
          <i data-lucide="shopping-cart" class="h-4 w-4"></i>
          <span class="cta-shine animate-btnshine"></span>
          <span class="corner-bling"></span>
        </a>
      </div>
    </div>

    <!-- About -->
    <div data-aos="fade-up">
      <h2 class="text-2xl font-bold mb-2">About this Ebook</h2>
      <p class="text-zinc-300 leading-relaxed">The Bhagavad Gita is more than scripture, it's a guide to life. This edition brings out simplified explanations, practical examples, and modern reflections for today's reader.</p>
    </div>

    <!-- Q&A & Reviews (unchanged from your page) -->
    <div data-aos="fade-up">
      <h2 class="text-2xl font-bold mb-4">Q&A</h2>
      <div class="divide-y divide-white/10 rounded-xl border border-white/10 bg-white/5">
        <details class="p-4 transition-all">
          <summary class="cursor-pointer font-semibold flex justify-between items-center">
            Is this ebook beginner-friendly?
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </summary>
          <div class="details-content"><p class="mt-2 text-sm text-zinc-300">Yes. It's written in simple language with clear takeaways after each chapter.</p></div>
        </details>
        <details class="p-4 transition-all">
          <summary class="cursor-pointer font-semibold flex justify-between items-center">
            Can I read it offline?
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </summary>
          <div class="details-content"><p class="mt-2 text-sm text-zinc-300">Yes. After purchase you can download and read anytime without internet.</p></div>
        </details>
        <details class="p-4 transition-all">
          <summary class="cursor-pointer font-semibold flex justify-between items-center">
            Does it include original verses?
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </summary>
          <div class="details-content"><p class="mt-2 text-sm text-zinc-300">Yes. Original verses with English explanations and practical notes.</p></div>
        </details>
      </div>
    </div>
    
    <!-- Feedbacks (10+ with Show More) -->
    <div id="feedbacks" data-aos="fade-up">
      <h2 class="text-2xl font-bold mb-1">What our readers say</h2>
      <p class="mb-4 text-sm text-zinc-400">These are the most repeated points readers mentioned.</p>

      <div class="grid gap-4 md:grid-cols-2" id="feedback-list">
        <!-- Visible first 4 -->
        <!-- 4.5/5 -->
        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star-half" class="h-4 w-4 half"></i>
            </div>
            <span class="text-[11px] text-zinc-400">27 Aug 2025 • 2:14 PM</span>
          </div>
          <p class="text-sm">"This ebook completely changed my perspective on life!"</p>
          <span class="text-xs text-zinc-400">— Aarav, India</span>
        </div>

        <!-- 4/5 -->
        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 empty"></i>
            </div>
            <span class="text-[11px] text-zinc-400">25 Aug 2025 • 6:02 PM</span>
          </div>
          <p class="text-sm">"Simple yet profound. Easy to read and understand."</p>
          <span class="text-xs text-zinc-400">— Emma, UK</span>
        </div>

        <!-- 5/5 -->
        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
            </div>
            <span class="text-[11px] text-zinc-400">22 Aug 2025 • 11:35 AM</span>
          </div>
          <p class="text-sm">"The wisdom feels so relevant to modern challenges."</p>
          <span class="text-xs text-zinc-400">— Michael, USA</span>
        </div>

        <!-- 4/5 -->
        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 empty"></i>
            </div>
            <span class="text-[11px] text-zinc-400">18 Aug 2025 • 9:18 PM</span>
          </div>
          <p class="text-sm">"Reading it gave me peace and direction."</p>
          <span class="text-xs text-zinc-400">— Li Wei, China</span>
        </div>

        <!-- Hidden extra 8+ reviews -->
        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star-half" class="h-4 w-4 half"></i>
            </div>
            <span class="text-[11px] text-zinc-400">14 Aug 2025 • 3:47 PM</span>
          </div>
          <p class="text-sm">"A must-have for anyone seeking clarity."</p>
          <span class="text-xs text-zinc-400">— Sophia, Canada</span>
        </div>

        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star-half" class="h-4 w-4 half"></i>
            </div>
            <span class="text-[11px] text-zinc-400">10 Aug 2025 • 7:02 PM</span>
          </div>
          <p class="text-sm">"Beautifully structured. The summaries are super helpful."</p>
          <span class="text-xs text-zinc-400">— Priya, India</span>
        </div>

        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 empty"></i>
            </div>
            <span class="text-[11px] text-zinc-400">06 Aug 2025 • 10:26 AM</span>
          </div>
          <p class="text-sm">"Great translation, very accessible for beginners."</p>
          <span class="text-xs text-zinc-400">— Daniel, Australia</span>
        </div>

        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star-half" class="h-4 w-4 half"></i>
            </div>
            <span class="text-[11px] text-zinc-400">04 Aug 2025 • 8:11 PM</span>
          </div>
          <p class="text-sm">"Loved the practical notes and exercises at the end of chapters."</p>
          <span class="text-xs text-zinc-400">— Neha, India</span>
        </div>

        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 empty"></i>
            </div>
            <span class="text-[11px] text-zinc-400">02 Aug 2025 • 5:30 PM</span>
          </div>
          <p class="text-sm">"Clear language. I finally understood the core ideas."</p>
          <span class="text-xs text-zinc-400">— Omar, UAE</span>
        </div>

        <div class="p-4 rounded-xl bg-white/5 shadow-glow animate-slideUp hidden extra-feedback">
          <div class="flex items-center justify-between mb-1">
            <div class="star-glow flex items-center gap-1">
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star" class="h-4 w-4 filled"></i>
              <i data-lucide="star-half" class="h-4 w-4 half"></i>
            </div>
            <span class="text-[11px] text-zinc-400">31 Jul 2025 • 4:58 PM</span>
          </div>
          <p class="text-sm">"The commentary connects ancient wisdom to daily life perfectly."</p>
          <span class="text-xs text-zinc-400">— Elena, Spain</span>
        </div>
      </div>

      <button id="showMore" class="mt-4 inline-block rounded-xl border border-white/10 bg-white/10 px-4 py-2 text-sm text-white hover:bg-white/20 transition">Show More</button>
    </div>
    
  </section>

  <footer class="mt-12 border-t border-white/10 py-8 text-center text-sm text-zinc-400">
    © <span id="year"></span> BookMintor. All rights reserved.
  </footer>

  <script>
    // Preloader functionality - FIXED
    document.addEventListener('DOMContentLoaded', function() {
      const preloader = document.getElementById('bm-preloader');
      let minLoadTime = 600;
      let startTime = Date.now();
      
      function hidePreloader() {
        const elapsed = Date.now() - startTime;
        const remaining = Math.max(0, minLoadTime - elapsed);
        
        setTimeout(() => {
          preloader.classList.add('fade-out');
          setTimeout(() => {
            preloader.classList.add('hidden');
          }, 2500);
        }, remaining);
      }
      
      // Hide when everything is loaded
      window.addEventListener('load', hidePreloader);
      
      // Fallback: if still visible after 4 seconds, force hide
      setTimeout(hidePreloader, 4000);
    });

    // --- CONFIG: change this IMAGE URL if needed ---
    // Provided image that has white background:
    const SOURCE_IMAGE = 'https://bookmintstore.github.io/home/images/ChatGPT%20Image%20Sep%2023,%202025,%2010_15_30%20PM.png';
    // white removal threshold (0-255); lower = stricter (keeps more light pixels)
    const WHITE_THRESHOLD = 245;

    // DOM refs
    const coverImg = document.getElementById('coverImg');
    const err = document.createElement('div'); err.className = 'proc-error'; document.querySelector('.book-wrap').appendChild(err);

    // Load & process image to remove white-ish background via canvas (creates PNG dataURL)
    function processImageToTransparent(url){
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = 'anonymous'; // requires server to allow CORS
        img.onload = () => {
          try {
            // limit dimensions for perf
            const max = 1200;
            let w = img.width, h = img.height;
            if(Math.max(w,h) > max){
              const r = max / Math.max(w,h);
              w = Math.round(w * r); h = Math.round(h * r);
            }
            const canvas = document.createElement('canvas');
            canvas.width = w; canvas.height = h;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, w, h);
            const data = ctx.getImageData(0,0,w,h);
            const d = data.data;

            // iterate and make white-ish pixels transparent
            for(let i=0;i<d.length;i+=4){
              const r = d[i], g = d[i+1], b = d[i+2], a = d[i+3];
              const maxc = Math.max(r,g,b), minc = Math.min(r,g,b);
              // if pixel very light and channels almost same -> treat as white-ish
              if(maxc >= WHITE_THRESHOLD && (maxc - minc) < 12){
                d[i+3] = 0; // transparent
              }
            }
            ctx.putImageData(data,0,0);
            const out = canvas.toDataURL('image/png');
            resolve(out);
          } catch(e) { reject(e); }
        };
        img.onerror = () => reject(new Error('Image failed to load (CORS or bad URL).'));
        img.src = url + (url.includes('?') ? '&' : '?') + 'cb=' + Date.now();
      });
    }

    // try processing and fallback to raw image if failed
    (async function(){
      try {
        const processed = await processImageToTransparent(SOURCE_IMAGE);
        coverImg.src = processed;
      } catch(e){
        console.warn('Processing failed:', e);
        err.style.display = 'block';
        err.textContent = '⚠️ Could not remove white background automatically (CORS likely). Showing original cover.';
        // fallback: show original image directly (may show white bg)
        coverImg.src = SOURCE_IMAGE;
      }
    })();

    // misc UI & init (unchanged)
    AOS.init({ duration: 650, easing: 'ease-out', once: true });
    lucide.createIcons();
    document.getElementById('year').textContent = new Date().getFullYear();

    // buy btn nibble
    window.addEventListener('load', ()=>{
      const bling = document.querySelector('#buyBtn .corner-bling');
      if(bling){ bling.style.opacity = 1; bling.classList.add('animate-cornerPop'); setTimeout(()=>{ bling.style.opacity = 0.75; }, 950); }
    });

    // details animation handling
    document.querySelectorAll('details').forEach(d=>{
      const content = d.querySelector('.details-content');
      if(!content) return;
      d.addEventListener('toggle', ()=>{
        if(d.open){
          content.style.height = content.scrollHeight + 'px';
          setTimeout(()=>{ content.style.height = 'auto'; }, 340);
        } else {
          content.style.height = content.scrollHeight + 'px';
          requestAnimationFrame(()=>{ content.style.height = '0px'; });
        }
      });
    });
    
    // Show More feedbacks
    const sm = document.getElementById('showMore');
    if(sm){
      sm.addEventListener('click', ()=>{
        document.querySelectorAll('.extra-feedback').forEach(el=>{
          el.classList.remove('hidden'); el.classList.add('block');
        });
        sm.style.display='none';
      });
    }
  </script>
</body>
</html>
